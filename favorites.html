<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的最愛</title>
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
</head>
<body>
    <h1>我的最愛食譜</h1>
    <div id="favorite-list"></div>

    <script>
        // 初始化 LIFF 應用
        liff.init({ liffId: "YOUR_LIFF_ID" }).then(() => {
            if (liff.isLoggedIn()) {
                // 使用者已登入，取得使用者資料
                liff.getProfile().then(profile => {
                    const userId = profile.userId;
                    // 發送 userId 到後端 API 來查詢使用者的收藏
                    fetch(`/favorites/${userId}`)
                        .then(response => response.json())
                        .then(data => {
                            // 顯示使用者的收藏
                            displayFavorites(data.favorites);
                        });
                });
            } else {
                liff.login();  // 未登入則提示登入
            }
        }).catch(err => {
            console.error('LIFF 初始化錯誤:', err);
        });

        // 顯示收藏
        function displayFavorites(favorites) {
            const favoriteList = document.getElementById('favorite-list');
            favorites.forEach(fav => {
                const favItem = document.createElement('div');
                favItem.innerHTML = `<h3>${fav.dish}</h3><p>${fav.recipe}</p><a href="${fav.link}">觀看影片</a>`;
                favoriteList.appendChild(favItem);
            });
        }
    </script>
</body>
</html>
